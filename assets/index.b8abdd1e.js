var B=Object.defineProperty;var g=Object.getOwnPropertySymbols;var I=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable;var F=(e,t,a)=>t in e?B(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,w=(e,t)=>{for(var a in t||(t={}))I.call(t,a)&&F(e,a,t[a]);if(g)for(var a of g(t))P.call(t,a)&&F(e,a,t[a]);return e};import{u as f,B as S,w as k,l as h,o as d,j as p,F as C,p as N,n as u,r as T,q as E,v as U,m as V,C as D,D as M}from"./vendor.c0915212.js";import"./ffmpeg.min.82a0fcc9.js";import{_ as $}from"./index.865ec351.js";const{createFFmpeg:R,fetchFile:q}=window.FFmpeg,x=e=>{const{media:t,count:a=9,fileName:r="video"}=e,n=f([]),c=f(0),l=S(()=>c.value/a),s=R({log:!1,corePath:"./FFmpeg/ffmpeg-core.js"});s.setProgress(o=>{o.duration&&(c.value=o.duration)}),k(async()=>{await y(t)});async function y(o){s.isLoaded()||await s.load(),s.FS("writeFile",r,await q(o)),await _(0,a)}async function _(o,i){const m=await L(o);if(n.value.push(w({},m)),o++,o>=i)return!1;setTimeout(()=>{_(o,i)},100)}async function L(o){const i=`${r}-poster-${o}.jpg`;await s.run("-ss",`${Math.floor(l.value*o)}`,"-i",r,"-frames","1","-to","10",i);const m=await s.FS("readFile",i),v=new Blob([m.buffer],{type:"jpg"}),b=new window.File([v],i,{type:"jpg"}),j=URL.createObjectURL(v);return{index:o,file:b,url:j}}return n};const O=h({props:{media:[String,File]},setup(e){return{dataList:x({media:e.media,count:9})}}}),z={class:"list"},A=["src"];function G(e,t,a,r,n,c){return d(),p("div",z,[(d(!0),p(C,null,N(e.dataList,(l,s)=>(d(),p("div",{class:"list-item",key:s},[u("img",{src:l.url,alt:""},null,8,A)]))),128))])}var H=$(O,[["render",G],["__scopeId","data-v-d616e682"]]);const J=h({name:"ffmpeg",components:{CreatePosterList:H},setup(){const e=f("https://video.591.com.tw/debug/source/house/2022-02-24/5529.mp4"),t=f(e.value);return{media:e,value:t,fileChange:n=>{e.value=n.target.files[0],console.log("file: ",n.target.files[0])},create:()=>{e.value=t.value}}}}),K=e=>(D("data-v-41f9301b"),e=e(),M(),e),Q=K(()=>u("br",null,null,-1));function W(e,t,a,r,n,c){const l=T("CreatePosterList");return d(),p(C,null,[E(u("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=s=>e.value=s),"input-default":"",class:"input"},null,512),[[U,e.value]]),u("button",{"btn-default":"",onClick:t[1]||(t[1]=(...s)=>e.create&&e.create(...s))},"\u751F\u6210\u5C01\u9762\u56FE"),Q,u("input",{type:"file",accept:"video/*",onChange:t[2]||(t[2]=(...s)=>e.fileChange&&e.fileChange(...s))},null,32),V(l,{media:e.media},null,8,["media"])],64)}var te=$(J,[["render",W],["__scopeId","data-v-41f9301b"]]);export{te as default};
